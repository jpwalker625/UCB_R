---
title: "Assignment_3"
author: "Joseph Walker"
date: "3/19/2017"
output: 
  html_document: 
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

###Problem 1
The U.S. Government Department of Labor, Bureau of Labor Statistics (BLS) publishes a Local Area
Unemployent Report, overview available here:

* https://www.bls.gov/lau/lauov.htm

Data format description here:

* https://www.bls.gov/help/hlpforma.htm#LA


Assignment:
Tidy the data set provided and generate four separate ggplot line plots (including points) of the following:

1. Employment
2. Labor Force
3. Unemploment Rate
4. Unemployment



```{r sf_oak_metro data}
#load packages
library(tidyverse)
library(forcats)
library(lubridate)
library(jsonlite)
library(tidyjson)

#read in data
df<- read_csv("sf_oak_metro.csv", col_names = T)

#tidy Data
sf_oak <- gather(df, Date, Value, -`Series ID`)

glimpse(sf_oak)

#uniform column names (lower case)
colnames(sf_oak) <- colnames(sf_oak) %>% tolower()

#rename the factors
sf_oak$`series id` <- sf_oak$`series id` %>% 
                      fct_recode(unemployment_rate = "LAUMT064186000000003",
                                 unemployment = "LAUMT064186000000004",
                                 employment = "LAUMT064186000000005",
                                 labor_force = "LAUMT064186000000006")


#parse date variable with lubridate functions
sf_oak$date <- parse_date_time2(sf_oak$date, '%b! %Y!')
sf_oak$month <- month(sf_oak$date,label = TRUE)
sf_oak$year <- as.factor(year(sf_oak$date))

sf_oak %>%
  filter(`series id` == 'employment') %>%
  ggplot(aes(month, value, group = year, colour = year)) +
  geom_point() +
  geom_line() +
  ggtitle(label = 'Monthly Employment Statistics for the San Francisco-Oakland-Hayward Metropolitan Area', 
          subtitle = '1990-2016') +
  theme(plot.title = element_text(size = 10, face = 'bold'),
        plot.subtitle = element_text(size = 10))


sf_oak %>%
  filter(`series id` == 'labor_force') %>%
  ggplot(aes(month, value, group = year, colour = year)) +
  geom_point() +
  geom_line() +
  ggtitle(label = 'Monthly Labor Force Statistics for the San Francisco-Oakland-Hayward Metropolitan Area', 
          subtitle = '1990-2016') +
  theme(plot.title = element_text(size = 10, face = 'bold'),
        plot.subtitle = element_text(size = 10))

sf_oak %>%
  filter(`series id` == 'unemployment') %>%
  ggplot(aes(month, value, group = year, colour = year)) +
  geom_point() +
  geom_line() +
  ggtitle(label = 'Monthly Unemployment Statistics for the San Francisco-Oakland-Hayward Metropolitan Area', 
          subtitle = '1990-2016') +
  theme(plot.title = element_text(size = 10, face = 'bold'),
        plot.subtitle = element_text(size = 10))

sf_oak %>%
  filter(`series id` == 'unemployment_rate') %>%
  ggplot(aes(month, value, group = year, colour = year)) +
  geom_point() +
  geom_line() +
  ggtitle(label = 'Monthly Unemployment Rate Statistics for the San Francisco-Oakland-Hayward Metropolitan Area', 
          subtitle = '1990-2016') +
  theme(plot.title = element_text(size = 10, face = 'bold'),
        plot.subtitle = element_text(size = 10))

```

###Problem 2

```{r problem 2}
json <- do.call(rbind,
lapply(paste(readLines("gz_2010_us_050_00_20m.json", warn=FALSE),
collapse=""),
jsonlite::fromJSON))

df <- as.data.frame(df$features)

stream_in(file('gz_2010_us_050_00_20m.json'))
fromJSON("gz_2010_us_050_00_20m.json",simplifyDataFrame = T)
json <- read_lines_raw("gz_2010_us_050_00_20m.json")

"usa_county_map.txt" %>% gather_array()
json %>% gather_array()

```
